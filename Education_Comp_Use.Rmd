---
title: "690V Data Visualization Practice"
author: "Group 2"
date: "`r Sys.Date()`"
format:
  html:
    toc: true
    code-fold: true
    code-copy: true
    code-tools: true
---

```{r}
install.packages("reader")
```

```{r setup, include=FALSE}
library(readr)
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)
```

## Import Data

```{r setup, include=FALSE}
Edu_Comp_22 <- read_csv("Data/Edu_Comp_22.csv")
Code_book <- read_csv("Data/Code Book.csv")
```

## Prepare Data

```{r}
# Read the data set 
data <- read.csv("Data/Edu_Comp_22.csv", header = FALSE, skip = 2) # Skip first two rows
col_names <- read.csv("Data/Edu_Comp_22.csv", header = FALSE, nrows = 1) # Read only the first row as column names
colnames(data) <- col_names # Assign column names to the data

# Remove columns with margin of error
cols_to_remove <- grep("M$", col_names) 
data <- data[, -cols_to_remove, drop = FALSE] # Remove identified columns

# Remove last NA column
data <- data[, -ncol(data), drop = FALSE]

# Replace headers with new_col_names
colnames(data) <- new_col_names
```

# Categorical Plot

```{r}
data <- data %>%
  mutate(
    Region = case_when(
      State %in% c("Connecticut", "Maine", "Massachusetts", "New Hampshire", "Rhode Island", "Vermont") ~ "New England",
      State %in% c("Delaware", "District of Columbia", "Maryland", "New Jersey", "New York", "Pennsylvania") ~ "Mideast",
      State %in% c("Illinois", "Indiana", "Michigan", "Ohio", "Wisconsin") ~ "Great Lakes",
      State %in% c("Iowa", "Kansas", "Minnesota", "Missouri", "Nebraska", "North Dakota", "South Dakota") ~ "Plains",
      State %in% c("Alabama", "Arkansas", "Florida", "Georgia", "Kentucky", "Louisiana", "Mississippi", "North Carolina", "South Carolina", "Tennessee", "Virginia", "West Virginia") ~ "Southeast",
      State %in% c("Arizona", "New Mexico", "Oklahoma", "Texas") ~ "Southwest",
      State %in% c("Colorado", "Idaho", "Montana", "Utah", "Wyoming") ~ "Rocky Mountain",
      State %in% c("Puerto Rico") ~ "Puerto Rico",
      State %in% c("Alaska", "California", "Hawaii", "Nevada", "Oregon", "Washington") ~ "Far West",
      TRUE ~ NA_character_
    )
  )

```

## Bar Graph

```{r}
library(ggplot2)
library(dplyr)
library(tidyr)

ggplot(data, aes(x = Region)) +
  geom_bar() +
  labs(title = "Bar graph of Region",
       x = "Region",
       y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
```{r}
rows_with_na <- which(rowSums(is.na(data)) > 0)

# Display rows with NA values
print(data[rows_with_na, ])
```


## Sample Histogram

```{r}
ggplot(data, aes(x = `State Total`)) +
  geom_histogram(binwidth = 1000000, fill = "skyblue", color = "black") +
  labs(title = "State Population Distribution",
       x = "Population in Millions",
       y = "Number of States") +
  scale_y_continuous(breaks = seq(0, 14, by = 2),
                     labels = function(x) format(x, scientific = FALSE)) +
  scale_x_continuous(breaks = seq(0, max(data$`State Total`), by = 5e6),
                     labels = function(x) format(x / 1e6, scientific = FALSE, big.mark = ",")) +
  theme_minimal()

```


```{r}
ggplot(data, aes(x = B28006_019E)) +
  geom_histogram(bins = 50, fill = 'red', color = 'black') +
  labs(title = 'Internet access distribution',
      x = 'internet access',
      y = 'frequency') +
      facet_wrap(~NAME)
```